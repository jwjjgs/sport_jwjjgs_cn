{"version":3,"sources":["pages/Home/index.js","pages/Login/index.js","pages/Map/index.js","Routes.js","boot.js","index.js"],"names":["VERSION","getRandom","n","m","Math","floor","random","getNearLoc","loc","limit","parseFloat","getUser","Promise","resolve","reject","axios","get","then","res","runningRule","rule","userCampus","catch","getStart","campusId","orgId","latitude","longitude","data","Object","assign","type","post","randomCircuit","getEnd","circuitString","distance","time","path","_circuitString","moment","format","circuitInfo","JSON","stringify","version","valid","id","platform","stepRate","invalidReason","validDistance","phone","startTime","valueOf","endTime","add","calories","parseInt","totalTime","latitudeArr","longitudeArr","speedArr","segment","requireLatitude","requireLongitude","_path","parse","base64","decode","map","i","Array","isArray","j","speed","speedConfig","avg","length","start","_segment","index","push","md5","_data","keys","sort","item","Home","useState","list","setList","useRequest","obj","a","e","message","end","manual","onSuccess","success","listRun","onError","error","loading","run","pageNum","subtract","pageSize","items","listLoading","useEffect","title","subTitle","extra","to","direction","style","width","size","Text","href","onFinish","Item","name","addonBefore","placeholder","addonAfter","htmlType","block","itemLayout","dataSource","renderItem","Meta","avatar","CheckCircleTwoTone","twoToneColor","CloseCircleTwoTone","description","pathname","state","icon","EyeOutlined","Login","history","useHistory","orgs","setOrgs","params","orgType","label","value","url","method","result","token","localStorage","setItem","initialValues","username","password","rules","required","maxLength","Password","options","Map","props","info","setInfo","location","combine","arr","longitude_","reduce","latitude_","coords","AMapLoader","load","key","plugins","AMap","center","zoom","polyline","Polyline","strokeColor","strokeWeight","strokeStyle","console","log","onBack","ShareAltOutlined","onClick","warning","str","copy","encode","height","paddingTop","marginTop","Routes","component","render","getItem","router","HashRouter","defaults","withCredentials","baseURL","headers","interceptors","request","use","config","toLowerCase","authorization","response","code","_message","Msg","content","err","status","error_description","clear","ReactDOM","requestMethod","param","document","getElementById"],"mappings":"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","file":"static/js/main.fe1e32ff.chunk.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Link, Switch } from \"react-router-dom\";\r\nimport {\r\n  Button,\r\n  Card,\r\n  Form,\r\n  Input,\r\n  List,\r\n  message,\r\n  PageHeader,\r\n  Space,\r\n  Typography,\r\n} from \"antd\";\r\nimport {\r\n  CloseCircleTwoTone,\r\n  CheckCircleTwoTone,\r\n  EyeOutlined,\r\n} from \"@ant-design/icons\";\r\nimport { useRequest } from \"ahooks\";\r\nimport axios from \"axios\";\r\nimport moment from \"moment\";\r\nimport md5 from \"js-md5\";\r\nimport { Base64 as base64 } from \"js-base64\";\r\n\r\nconst VERSION = \"V 2.5.6\";\r\n\r\nconst getRandom = (n, m) => Math.floor(Math.random() * (m - n + 1)) + n;\r\n\r\nconst getNearLoc = (loc, limit = 1000) =>\r\n  parseFloat(loc) + getRandom(-1 * limit, limit) / limit / 10000000;\r\n\r\nconst getList = (pageNum) =>\r\n  new Promise((resolve, reject) => {\r\n    const startTime = moment().subtract(720, \"days\").valueOf();\r\n    const endTime = moment().valueOf();\r\n    axios\r\n      .post(\"running/api/v1/running/recordList\", {\r\n        pageNum,\r\n        pageSize: 100,\r\n        startTime,\r\n        endTime,\r\n      })\r\n      .then((res) => {\r\n        resolve(res.items);\r\n      })\r\n      .catch(() => {\r\n        reject(\"获取列表失败\");\r\n      });\r\n  });\r\n\r\nconst getUser = () =>\r\n  new Promise((resolve, reject) => {\r\n    axios\r\n      .get(\"/health/api/v1/homePage/user\")\r\n      .then((res) => {\r\n        const {\r\n          runningRule: { rule, userCampus },\r\n        } = res;\r\n        //{rule:{},userCampus:{}}\r\n        resolve({\r\n          rule,\r\n          userCampus,\r\n        });\r\n      })\r\n      .catch(() => {\r\n        reject(false);\r\n      });\r\n  });\r\n\r\nconst getStart = (campusId, orgId) =>\r\n  new Promise((resolve, reject) => {\r\n    const loc = {};\r\n    switch (orgId) {\r\n      case 368:\r\n        loc.latitude = `30.786842${getRandom(10000, 99999)}`;\r\n        loc.longitude = `103.886128${getRandom(10000, 99999)}`;\r\n        break;\r\n      case 53:\r\n        loc.latitude = `30.826795${getRandom(10000, 99999)}`;\r\n        loc.longitude = `104.18535${getRandom(10000, 99999)}`;\r\n        break;\r\n      case 444:\r\n        loc.latitude = `30.82454${getRandom(10000, 99999)}`;\r\n        loc.longitude = `106.118579${getRandom(10000, 99999)}`;\r\n        break;\r\n      case 386:\r\n        loc.latitude = `30.728711${getRandom(10000, 99999)}`;\r\n        loc.longitude = `103.965401${getRandom(10000, 99999)}`;\r\n        break;\r\n      case 418:\r\n        loc.latitude = `30.764069${getRandom(10000, 99999)}`;\r\n        loc.longitude = `103.985006${getRandom(10000, 99999)}`;\r\n        break;\r\n      default:\r\n        return reject(false);\r\n    }\r\n    const data = Object.assign(\r\n      {},\r\n      {\r\n        campusId,\r\n        type: 1,\r\n      },\r\n      {\r\n        ...loc,\r\n      }\r\n    );\r\n    axios\r\n      .post(\"/running/api/v1/running/start\", { ...data })\r\n      .then((res) => {\r\n        const { randomCircuit } = res;\r\n        //{...randomCircuit}\r\n        resolve({ ...randomCircuit });\r\n      })\r\n      .catch(() => {\r\n        reject(false);\r\n      });\r\n  });\r\nconst getEnd = (circuitString = {}, distance = 0, time = 0, path) =>\r\n  new Promise((resolve, reject) => {\r\n    //circuitString = { runningRule, randomCircuit }\r\n    //{runningRule:{rule:{},userCampus:{}},randomCircuit:{}}\r\n    const _circuitString = {\r\n      ...circuitString,\r\n      time: moment().format(\"YYYY-MM-DD HH:mm:ss\"),\r\n    };\r\n    const data = {\r\n      circuitInfo: {\r\n        circuitString: JSON.stringify(_circuitString),\r\n      },\r\n      version: VERSION,\r\n      valid: 1,\r\n      id: 1,\r\n      type: 1,\r\n      platform: 1,\r\n      stepRate: getRandom(40, 80),\r\n      invalidReason: \"\",\r\n      distance: distance,\r\n      validDistance: distance,\r\n      phone: \"\",\r\n      startTime: moment().valueOf(),\r\n      endTime: moment().add(time, \"seconds\").valueOf(),\r\n      calories: parseInt(distance / 20),\r\n      totalTime: time,\r\n    };\r\n    let latitudeArr = [],\r\n      longitudeArr = [],\r\n      speedArr = [],\r\n      segment = [];\r\n    const { requireLatitude, requireLongitude } = _circuitString.randomCircuit;\r\n    if (!path) {\r\n      for (let i = 0; i < 3; i++) {\r\n        latitudeArr.push(requireLatitude[i]);\r\n        longitudeArr.push(requireLongitude[i]);\r\n        speedArr.push(getRandom(2, 20));\r\n      }\r\n      latitudeArr = [latitudeArr];\r\n      longitudeArr = [longitudeArr];\r\n      segment = [\r\n        [\r\n          data.startTime + getRandom(10, 100),\r\n          data.endTime - getRandom(1500, 2500),\r\n        ],\r\n      ];\r\n    } else {\r\n      const _path = JSON.parse(base64.decode(path));\r\n      latitudeArr = _path.latitude.map((i) =>\r\n        Array.isArray(i) ? i.map((j) => getNearLoc(j)) : getNearLoc(i)\r\n      );\r\n      longitudeArr = _path.longitude.map((i) =>\r\n        Array.isArray(i) ? i.map((j) => getNearLoc(j)) : getNearLoc(i)\r\n      );\r\n      speedArr = _path.speed.map((i) =>\r\n        Array.isArray(i) ? i.map(() => getRandom(2, 20)) : i\r\n      );\r\n      const speedConfig = {\r\n        avg: data.totalTime / speedArr.length,\r\n        start: 0,\r\n      };\r\n      for (let i of latitudeArr) {\r\n        const _segment = [];\r\n        if (Array.isArray(i)) {\r\n          for (let index = 0; index < i.length - 1; index++) {\r\n            speedConfig.start += speedConfig.avg + getRandom(-10, 10);\r\n            _segment.push(moment().add(speedConfig.start, \"seconds\").valueOf());\r\n          }\r\n          segment.push(_segment);\r\n        }\r\n      }\r\n    }\r\n\r\n    data.circuitInfo = {\r\n      ...data.circuitInfo,\r\n      latitude: latitudeArr,\r\n      longitude: longitudeArr,\r\n      segment: segment,\r\n      speed: speedArr,\r\n      calories: parseInt(distance / 20),\r\n    };\r\n    data.md5 = md5(\r\n      `EndRunningInfo{a='${data.invalidReason}', b=${data.totalTime}, c=${data.distance}, d=${data.type}, e=${data.startTime}, f=${data.endTime}, g='${data.phone}'}`\r\n    );\r\n    const _data = {};\r\n    Object.keys(data)\r\n      .sort()\r\n      .map((item) => (_data[item] = data[item]));\r\n    axios\r\n      .post(`/running/api/v1/running/end3`, _data)\r\n      .then((res) => {\r\n        resolve(res);\r\n      })\r\n      .catch(() => {\r\n        reject(false);\r\n      });\r\n  });\r\n\r\nfunction Home() {\r\n  const [list, setList] = useState([]);\r\n\r\n  const { loading, run } = useRequest(\r\n    (obj) => {\r\n      return new Promise(async (resolve, reject) => {\r\n        //判断是否有导入路线\r\n        const { distance, time, path } = obj;\r\n\r\n        //获取用户信息\r\n        const runningRule = await getUser().catch(() =>\r\n          reject(\"获取用户信息失败\")\r\n        );\r\n        //获取跑步信息\r\n        const randomCircuit = await getStart(\r\n          runningRule.rule.campusId,\r\n          runningRule.rule.orgId\r\n        ).catch(() => reject(\"获取跑步信息失败\"));\r\n\r\n        //提交跑步信息\r\n        const end = await getEnd(\r\n          { runningRule, randomCircuit },\r\n          distance,\r\n          time,\r\n          path\r\n        ).catch((e) => {\r\n          reject(`结束跑步失败${e.message}`);\r\n        });\r\n        const { invalidReason, valid } = end;\r\n        if (valid === 1) resolve(true);\r\n        else reject(invalidReason);\r\n      });\r\n    },\r\n    {\r\n      manual: true,\r\n      onSuccess: () => {\r\n        message.success(\"跑步完成\");\r\n        listRun();\r\n      },\r\n      onError: (e) => {\r\n        message.error(e);\r\n        listRun();\r\n      },\r\n    }\r\n  );\r\n\r\n  const { loading: listLoading, run: listRun } = useRequest(() => getList(1), {\r\n    manual: true,\r\n    onSuccess: (res) => {\r\n      setList(res);\r\n    },\r\n    onError: (e) => {\r\n      message.error(e);\r\n    },\r\n  });\r\n\r\n  useEffect(() => {\r\n    listRun();\r\n    getUser();\r\n  }, []); //eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  return (\r\n    <>\r\n      <PageHeader\r\n        title=\"乐健\"\r\n        subTitle=\"完全免费\"\r\n        extra={\r\n          <Link to=\"/login\">\r\n            <Button type=\"link\">切换账号</Button>\r\n          </Link>\r\n        }\r\n      >\r\n        <Space direction=\"vertical\" style={{ width: \"100%\" }} size=\"large\">\r\n          <Card title=\"告知\" extra={<b>最后更新 2021/03/24</b>}>\r\n            <Typography.Text>\r\n              1.本功能属于纯前端实现，不存在收集，保留用户信息等\r\n              <br />\r\n            </Typography.Text>\r\n            <Typography.Text>\r\n              2.仅供学习研究使用，切勿用于非法或商业等用途\r\n              <br />\r\n            </Typography.Text>\r\n            <Typography.Text>\r\n              3.完全免费开源，请勿上当受骗，如果你是收费看到页面，请及时举报诈骗者\r\n              <br />\r\n            </Typography.Text>\r\n            <Typography.Text>\r\n              4.github:\r\n              <a href=\"https://github.com/jwjjgs/sport_jwjjgs_cn\">\r\n                点我查看开源代码/更新日志\r\n              </a>\r\n              <br />\r\n            </Typography.Text>\r\n          </Card>\r\n          <Card title=\"功能\">\r\n            <Form\r\n              onFinish={(e) => {\r\n                run(e);\r\n              }}\r\n            >\r\n              <Form.Item name=\"path\">\r\n                <Input addonBefore=\"轨迹\" placeholder=\"请粘贴导出轨迹(选填)\" />\r\n              </Form.Item>\r\n              <Form.Item name=\"distance\">\r\n                <Input addonBefore=\"距离\" addonAfter=\"米\" />\r\n              </Form.Item>\r\n              <Form.Item name=\"time\">\r\n                <Input addonBefore=\"时间\" addonAfter=\"秒\" />\r\n              </Form.Item>\r\n              <Form.Item>\r\n                <Button\r\n                  htmlType=\"submit\"\r\n                  type=\"primary\"\r\n                  block\r\n                  loading={loading}\r\n                >\r\n                  奔跑\r\n                </Button>\r\n              </Form.Item>\r\n            </Form>\r\n          </Card>\r\n\r\n          <List\r\n            loading={listLoading}\r\n            itemLayout=\"horizontal\"\r\n            dataSource={list}\r\n            renderItem={(item) => (\r\n              <List.Item>\r\n                <List.Item.Meta\r\n                  avatar={\r\n                    item.valid === 1 ? (\r\n                      <CheckCircleTwoTone twoToneColor=\"#52c41a\" />\r\n                    ) : (\r\n                      <CloseCircleTwoTone twoToneColor=\"#eb2f96\" />\r\n                    )\r\n                  }\r\n                  title={`距离:${item.validDistance}米 时间:${\r\n                    item.totalTime >= 60 && parseInt(item.totalTime / 60) + \"分\"\r\n                  }${(item.totalTime % 60) + \"秒\"}`}\r\n                  description={item.startTime}\r\n                />\r\n                <Link\r\n                  to={{\r\n                    pathname: \"/map\",\r\n                    state: {\r\n                      circuitInfo: JSON.parse(item.circuitInfo),\r\n                    },\r\n                  }}\r\n                >\r\n                  <Button icon={<EyeOutlined />} type=\"link\"></Button>\r\n                </Link>\r\n              </List.Item>\r\n            )}\r\n          />\r\n        </Space>\r\n      </PageHeader>\r\n    </>\r\n  );\r\n}\r\nexport default Home;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { Button, Form, Input, message, PageHeader, Select } from \"antd\";\r\nimport { useRequest } from \"ahooks\";\r\nimport { useHistory } from \"react-router\";\r\nimport axios from \"axios\";\r\nfunction Login() {\r\n  const history = useHistory();\r\n  const [orgs, setOrgs] = useState([]);\r\n  useEffect(() => {\r\n    axios\r\n      .get(\"/health/api/v2/organization/list\", {\r\n        params: {\r\n          orgType: 1,\r\n        },\r\n      })\r\n      .then((res) => {\r\n        setOrgs(res.map((i) => ({ label: i.name, value: i.id })));\r\n      });\r\n  }, []);\r\n\r\n  const { loading, run } = useRequest(\r\n    (obj) => ({\r\n      url: \"/health/api/v1/login\",\r\n      method: \"post\",\r\n      data: { ...obj },\r\n    }),\r\n    {\r\n      manual: true,\r\n      onSuccess: (result) => {\r\n        const { token } = result;\r\n        localStorage.setItem(\"token\", `Bearer ${token}`);\r\n        message.success(\"登陆成功\");\r\n        history.push(\"/\");\r\n      },\r\n    }\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <PageHeader title=\"登录\">\r\n        <Form\r\n          onFinish={(e) => run(e)}\r\n          initialValues={{ username: \"\", password: \"\" }}\r\n        >\r\n          <Form.Item\r\n            name=\"username\"\r\n            rules={[{ required: true, message: \"请输入账号\" }]}\r\n          >\r\n            <Input addonBefore=\"账号\" type=\"tel\" maxLength={11} />\r\n          </Form.Item>\r\n          <Form.Item\r\n            name=\"password\"\r\n            maxLength={16}\r\n            rules={[{ required: true, message: \"请输入密码\" }]}\r\n          >\r\n            <Input.Password addonBefore=\"密码\" />\r\n          </Form.Item>\r\n          <Form.Item\r\n            name=\"orgId\"\r\n            rules={[{ required: true, message: \"请选择地区\" }]}\r\n          >\r\n            <Select options={orgs} />\r\n          </Form.Item>\r\n          <Form.Item>\r\n            <Button htmlType=\"submit\" type=\"primary\" block loading={loading}>\r\n              登录\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n      </PageHeader>\r\n    </>\r\n  );\r\n}\r\nexport default Login;\r\n","import { Button, message, PageHeader } from \"antd\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport AMapLoader from \"@amap/amap-jsapi-loader\";\r\nimport { ShareAltOutlined } from \"@ant-design/icons\";\r\nimport copy from \"copy-to-clipboard\";\r\nimport { Base64 as base64 } from \"js-base64\";\r\n\r\nfunction Map(props) {\r\n  const [info, setInfo] = useState(null);\r\n  useEffect(() => {\r\n    try {\r\n      //得到传入数据\r\n      const {\r\n        location: {\r\n          state: {\r\n            circuitInfo: { longitude, latitude, speed },\r\n          },\r\n        },\r\n      } = props;\r\n      setInfo({ longitude, latitude, speed });\r\n      //将传入数据 longitude = [[...],[...],...]  ... 转为一维数组\r\n      const combine = (arr, i) => {\r\n        if (Array.isArray(i)) arr.push(...i);\r\n        else arr.push(i);\r\n        return arr;\r\n      };\r\n      const longitude_ = longitude.reduce(combine, []);\r\n      const latitude_ = latitude.reduce(combine, []);\r\n\r\n      //将两个一维数组转字符串[]\r\n      const coords = [];\r\n      for (let i = 0; i < longitude_.length; i++)\r\n        coords.push([longitude_[i], latitude_[i]]);\r\n      if (coords.length > 0) {\r\n        AMapLoader.load({\r\n          key: \"3f3868abdb36336114bde5ab6eecdb68\", // 申请好的Web端开发者Key，首次调用 load 时必填\r\n          plugins: [], // 需要使用的的插件列表，如比例尺'AMap.Scale'等\r\n        })\r\n          .then((AMap) => {\r\n            const map = new AMap.Map(\"map\", {\r\n              center: coords[0],\r\n              zoom: 17,\r\n            });\r\n            const polyline = new AMap.Polyline({\r\n              path: coords, //设置线覆盖物路径\r\n              strokeColor: \"#3366FF\", //线颜色\r\n              strokeWeight: 3, //线宽\r\n              strokeStyle: \"solid\", //线样式\r\n            });\r\n            map.add(polyline);\r\n          })\r\n          .catch((e) => {\r\n            console.log(e);\r\n          });\r\n      }\r\n    } catch {}\r\n  }, [props]);\r\n  return (\r\n    <>\r\n      <PageHeader\r\n        title=\"轨迹显示\"\r\n        onBack={() => {\r\n          props.history.push(\"/\");\r\n        }}\r\n        extra={[\r\n          <Button\r\n            key=\"export\"\r\n            type=\"link\"\r\n            icon={<ShareAltOutlined />}\r\n            onClick={() => {\r\n              try {\r\n                if (!info) {\r\n                  message.warning(\"导出失败\");\r\n                  return;\r\n                }\r\n                const str = JSON.stringify(info);\r\n                copy(base64.encode(str));\r\n                message.success(\"导出成功\");\r\n              } catch {\r\n                message.warning(\"导出失败\");\r\n              }\r\n            }}\r\n          ></Button>,\r\n        ]}\r\n      />\r\n      <div\r\n        style={{\r\n          height: \"100vh\",\r\n          paddingTop: \"72px\",\r\n          marginTop: \"-72px\",\r\n        }}\r\n      >\r\n        <div id=\"map\" style={{ height: \"100%\" }}></div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Map;\r\n","import React from \"react\";\r\nimport { HashRouter, Redirect, Route, Switch } from \"react-router-dom\";\r\nimport Home from \"./pages/Home\";\r\nimport Login from \"./pages/Login\";\r\nimport Map from \"./pages/Map\";\r\n\r\nfunction Routes() {\r\n  return (\r\n    <HashRouter>\r\n      <Switch>\r\n        <Route path=\"/login\" component={Login} />\r\n        <Route\r\n          path=\"/\"\r\n          render={() =>\r\n            !localStorage.getItem(\"token\") ? (\r\n              <Redirect to=\"/login\" />\r\n            ) : (\r\n              <Switch>\r\n                <Route path=\"/map\" component={Map} />\r\n                <Route path=\"/\" component={Home} />\r\n              </Switch>\r\n            )\r\n          }\r\n        />\r\n      </Switch>\r\n    </HashRouter>\r\n  );\r\n}\r\nexport default Routes;\r\n","import { message as Msg } from \"antd\";\r\nimport axios from \"axios\";\r\nimport { HashRouter } from \"react-router-dom\";\r\n\r\nconst router = new HashRouter();\r\n\r\naxios.defaults.withCredentials = false;\r\naxios.defaults.baseURL = \"https://upes.legym.cn/\";\r\naxios.defaults.headers.post[\"Content-Type\"] =\r\n  \"application/json;; charset=utf-8\";\r\naxios.interceptors.request.use((config) => {\r\n  if (\"post\" === config.method.toLowerCase() && typeof config.data === \"object\")\r\n    config.data = JSON.stringify(config.data);\r\n  const token = localStorage.getItem(\"token\");\r\n  if (token) config.headers.authorization = token;\r\n  return config;\r\n});\r\n\r\naxios.interceptors.response.use(\r\n  (res) => {\r\n    const {\r\n      data: { code, message, data },\r\n    } = res;\r\n    if (code !== 0) {\r\n      const _message = message || \"未知原因\";\r\n      Msg.warning({\r\n        content: _message,\r\n        key: _message,\r\n      });\r\n      return Promise.reject();\r\n    }\r\n    if (message)\r\n      Msg.success({\r\n        content: message,\r\n        key: message,\r\n      });\r\n    return data;\r\n  },\r\n  (err) => {\r\n    const {\r\n      response: {\r\n        status,\r\n        data: { error_description },\r\n      },\r\n    } = err;\r\n    if (status === 401) {\r\n      const _message = \"登录失效\";\r\n      Msg.warning({\r\n        content: _message,\r\n        key: _message,\r\n      });\r\n      localStorage.clear(\"token\");\r\n      router.history.push(\"/login\");\r\n    } else {\r\n      const _message = error_description;\r\n      Msg.warning({\r\n        content: _message,\r\n        key: _message,\r\n      });\r\n    }\r\n  }\r\n);\r\n","import { UseRequestProvider } from \"ahooks\";\r\nimport axios from \"axios\";\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport Routes from \"./Routes\";\r\nimport \"./boot\";\r\n\r\nReactDOM.render(\r\n  <UseRequestProvider\r\n    value={{\r\n      requestMethod: (param) => axios(param),\r\n    }}\r\n  >\r\n    <Routes />\r\n  </UseRequestProvider>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}